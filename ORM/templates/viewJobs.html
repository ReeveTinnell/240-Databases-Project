{% include "header.html" %}

<body>
    <h3>Job postings overview</h3>
    <table>
        <thead>
            <tr>
                <th>Title</th>
                <th>Company</th>
                <th>Contact</th>
                <th>Hyperlink</th>
                <th>Job Type</th>
                <th>Certifications</th>
            </tr>
        </thead>
        <tbody>
        {% for job in jobs %}
            <tr>
                <td><a href="/job/{{ job.id }}">{{ job.title }}</a></td>
                <td>{{ job.company.name }}</td>
                <td>{{ job.contact.phone }} / {{ job.contact.email }}</td>
                <td><a href="{{ job.hyperlink }}">{{job.hyperlink}}</a></td>
                <td>{{ job.type }}</td>
                <td>
                {% for cert in job.certs %}
                <a href="cert/{{cert.id}}">{{cert.name}}</a>
                {% endfor %}
                </td>
                 {% if session.user_id %}
                <td>
                    <button onclick="showDeleteForm({{ job.id }})">Delete</button>
                </td>
            </tr>
            <tr id="delete-form-{{ job.id }}" style="display: none;">
                <td colspan="7" style="background-color: #f8d7da; padding: 15px;">
                    <form method="POST" action="/job/delete/{{ job.id }}" style="margin: 0;">
                        <strong>Deleting: {{ job.title }}</strong>
                        <div class="form-group" style="margin: 10px 0;">
                            <label for="confirm-title-{{ job.id }}">Confirm job title:</label>
                            <input type="text" id="confirm-title-{{ job.id }}" name="title" required>
                        </div>
                        <button type="submit">Confirm Delete</button>
                        <button type="button" onclick="hideDeleteForm({{ job.id }})">Cancel</button>
                    </form>
                </td>
            </tr>
                {% endif %}
        {% endfor %}
        </tbody>
    </table>
<br>

<div style="text-align: center; margin-top: 2rem;">
    <p style="font-size: 2.0rem;">
        <a href='/job/new'>Add a new job</a>
    </p>
</div>

<script>
    function showDeleteForm(jobId) {
        // Hide all other delete forms
        document.querySelectorAll('[id^="delete-form-"]').forEach(form => {
            form.style.display = 'none';
        });
        // Show the selected delete form
        document.getElementById('delete-form-' + jobId).style.display = 'table-row';
    }

    function hideDeleteForm(jobId) {
        document.getElementById('delete-form-' + jobId).style.display = 'none';
        // Clear the input field
        document.getElementById('confirm-title-' + jobId).value = '';
    }
</script>

</body>

{% include "footer.html" %}
